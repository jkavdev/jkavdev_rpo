<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" 
      xmlns:ui="http://java.sun.com/jsf/facelets" 
      xmlns:h="http://java.sun.com/jsf/html" 
      xmlns:f="http://java.sun.com/jsf/core">

   <h:head>
   	<title>Gestao de Produtos</title>
   </h:head>
   
   <h:body>
   	<h:form>
   		<h:commandLink value="Ajuda sobre esta tela" action="#{gestaoProdutrosBean.obterAjuda}" >
   			<!-- chamando acao -->
   			<f:actionListener binding="#{registroCliequeBotaoListener}"/>
   		</h:commandLink>
   		<br />
   		Nome : <h:inputText value="#{gestaoProdutrosBean.produto.nome}" />
   		Fabricante : <h:inputText value="#{gestaoProdutrosBean.produto.fabricante}" />
   		Categoria : <h:inputText value="#{gestaoProdutrosBean.produto.categoria}" />
   		
   		<h:commandButton action="#{gestaoProdutrosBean.incluir}" value="Incluir" actionListener="#{gestaoProdutrosBean.verificarInclusao}" >
   			<f:actionListener binding="#{registroCliequeBotaoListener}"/>
   		</h:commandButton>
   	</h:form>
   	
   	<br />
   	
   	<h:form>
   		Pesquisa por fabricante:
   		<!-- com onchange, sera executado uma acao sempre que o valor do campo for alterado sem formula uma requisicao, em javascript -->
   		<!-- submit, fara com que o formulario seja atualizado -->
   		<h:inputText value="#{gestaoProdutrosBean.nomePesquisa}" valueChangeListener="#{gestaoProdutrosBean.nomePesquisaAlterado}"   		 
   			onchange="submit()"/>
   		<!-- implementando consulta sem formular a requisicao  -->   		
   		<!-- para issso faremos com javascript -->
   	</h:form>
   	
   	<h:form>
	   	<ol>
	  		<ui:repeat var="item" value="#{gestaoProdutrosBean.produtosFiltrados}">
	  			<li>
	  				#{item.nome} - #{item.fabricante} - #{item.categoria}
	  				<h:commandButton action="#{gestaoProdutrosBean.excluir}" value="Excluir" >
	  					<!-- informando que o item selecionado aq, sera o produto selecionado no bean a ser excluido -->
	  					<f:setPropertyActionListener value="#{item}" target="#{gestaoProdutrosBean.produtoSelecionado}" />
	  				</h:commandButton>
	  			</li>
	  		</ui:repeat>
		</ol>
	</h:form>

   	
   </h:body>
   
</html>